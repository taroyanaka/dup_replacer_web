<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Chord Quiz</title>
  <!-- <script src="https://unpkg.com/tone"></script> -->
  <script src="/lib/tone.js"></script>
</head>
<body>
  <h1>Chord Quiz</h1>
  <p>Click the button to play a random chord. Select the chord and click the "Check Answer" button.</p>
  <button id="play-chord">Play Chord</button>
  <select id="answer">
    <option value="">Select a chord</option>
    <option value="C Major 4">C Major 4</option>
    <option value="D Minor 4">D Minor 4</option>
    <option value="E Minor 4">E Minor 4</option>
    <option value="F Major 4">F Major 4</option>
    <option value="G Major 4">G Major 4</option>
    <option value="A Minor 4">A Minor 4</option>
    <option value="B Minor 4">B Minor 4</option>
    <option value="C Major 3">C Major 3</option>
    <option value="D Minor 3">D Minor 3</option>
    <option value="E Minor 3">E Minor 3</option>
    <option value="F Major 3">F Major 3</option>
    <option value="G Major 3">G Major 3</option>
    <option value="A Minor 3">A Minor 3</option>
    <option value="B Minor 3">B Minor 3</option>
    <option value="C Major 5">C Major 5</option>
    <option value="D Minor 5">D Minor 5</option>
    <option value="E Minor 5">E Minor 5</option>
    <option value="F Major 5">F Major 5</option>
    <option value="G Major 5">G Major 5</option>
    <option value="A Minor 5">A Minor 5</option>
    <option value="B Minor 5">B Minor 5</option>
  </select>
  <button id="check-answer">Check Answer</button>
  <p id="result"></p>
  <script>
    // 和音の配列を作成C_3からB_5までの和音
    const chords = [
        {name: 'C Major 4', notes: ['C4', 'E4', 'G4']},
        {name: 'D Minor 4', notes: ['D4', 'F4', 'A4']},
        {name: 'E Minor 4', notes: ['E4', 'G4', 'B4']},
        {name: 'F Major 4', notes: ['F4', 'A4', 'C5']},
        {name: 'G Major 4', notes: ['G4', 'B4', 'D5']},
        {name: 'A Minor 4', notes: ['A4', 'C5', 'E5']},
        {name: 'B Minor 4', notes: ['B4', 'D5', 'F#5']},

        {name: 'C Major 3', notes: ['C3', 'E3', 'G3']},
        {name: 'D Minor 3', notes: ['D3', 'F3', 'A3']},
        {name: 'E Minor 3', notes: ['E3', 'G3', 'B3']},
        {name: 'F Major 3', notes: ['F3', 'A3', 'C4']},
        {name: 'G Major 3', notes: ['G3', 'B3', 'D4']},
        {name: 'A Minor 3', notes: ['A3', 'C4', 'E4']},
        {name: 'B Minor 3', notes: ['B3', 'D4', 'F#4']},

        {name: 'C Major 5', notes: ['C5', 'E5', 'G5']},
        {name: 'D Minor 5', notes: ['D5', 'F5', 'A5']},
        {name: 'E Minor 5', notes: ['E5', 'G5', 'B5']},
        {name: 'F Major 5', notes: ['F5', 'A5', 'C6']},
        {name: 'G Major 5', notes: ['G5', 'B5', 'D6']},
        {name: 'A Minor 5', notes: ['A5', 'C6', 'E6']},
        {name: 'B Minor 5', notes: ['B5', 'D6', 'F#6']},
    ];

    // ランダムな和音を選択
    let currentChord = chords[Math.floor(Math.random() * chords.length)];

    // Synthを作成
    const synth = new Tone.Synth().toDestination();

    // Play Chordボタンをクリックしたときの処理
    document.getElementById('play-chord').addEventListener('click', () => {
      // 和音の各音符を演奏
      currentChord.notes.forEach(note => {
        synth.triggerAttackRelease(note, '2n');
      });
    });

    // Check Answerボタンをクリックしたときの処理
    document.getElementById('check-answer').addEventListener('click', () => {
      const answer = document.getElementById('answer').value;
      if (answer === currentChord.name) {
        document.getElementById('result').textContent = 'Correct!';
      } else {
        document.getElementById('result').textContent = 'Incorrect. The answer was ' + currentChord.name;
      }
      // 新しいランダムな和音を選択
      currentChord = chords[Math.floor(Math.random() * chords.length)];
      // 選択肢をリセット
      document.getElementById('answer').value = '';
    });
  </script>
</body>
</html>